<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:oxm="http://www.springframework.org/schema/oxm"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans 
           http://www.springframework.org/schema/beans/spring-beans.xsd
           http://www.springframework.org/schema/context 
           http://www.springframework.org/schema/context/spring-context.xsd
           http://www.springframework.org/schema/oxm 
           https://www.springframework.org/schema/oxm/spring-oxm.xsd
           http://www.springframework.org/schema/tx 
           http://www.springframework.org/schema/tx/spring-tx.xsd
           http://www.springframework.org/schema/aop
           http://www.springframework.org/schema/aop/spring-aop.xsd">


    <bean class="Wiprospringframework.SampleBean" id="mybean1" scope="singleton">
        <property name="username" value="Thananya"/>
    </bean>
  <bean id="mybean2" class="Wiprospringframework.Student">
    <property name="sid" value="101"/>
    <property name="sname" value="Rahul"/>
</bean>
  
    <bean class="Wiprospringframework.Student_Course" id="mybean3" parent="mybean2">
    <property name="courseid" value="10"/>
    <property name="coursename" value="Java"/>
</bean>
<bean id="bank" class="Wiprospringframework.Bank">
        <constructor-arg value="101"/>
        <constructor-arg value="Global Bank"/>
    </bean>
    <bean id="account" class="Wiprospringframework.Account">
        <constructor-arg value="50001"/>
        <constructor-arg value="John Doe"/>
        <constructor-arg value="1500.75"/>
        <constructor-arg ref="bank"/>
    </bean>
    
    <context:component-scan base-package="Wiprospringframework"/>
    
    <context:property-placeholder location="classpath:datafile.properties"/>

    
    <bean id="login" class="Wiprospringframework.LoginDetails">
        <property name="username" value="${username}"/>
        <property name="password" value="${password}"/>
    </bean>
    <bean id="product" class="Wiprospringframework.Product">
    <constructor-arg value="101"/>
    <constructor-arg value="Laptop"/>
    <constructor-arg value="55000"/>
</bean>
    

    <!-- Purchase bean with constructor-based autowiring -->
    <bean id="purchase" class="Wiprospringframework.Purchase">
    <constructor-arg value="5001"/>
    <constructor-arg>
        <bean class="java.util.Date"/>
    </constructor-arg>
    <constructor-arg ref="product"/>
</bean>
<aop:config>
    <aop:aspect ref="loggingAspect">
        <aop:pointcut id="allMethods" expression="execution(* Wiprospringframework.ShoppingService.*(..))"/>
        
        <aop:before method="logBefore" pointcut-ref="allMethods"/>
        <aop:after-returning method="logAfterReturning" pointcut-ref="allMethods" returning="result"/>
        <aop:after-throwing method="logAfterThrowing" pointcut-ref="allMethods" throwing="error"/>
        <aop:around method="logAround" pointcut-ref="allMethods"/>
    </aop:aspect>
</aop:config>

<bean id="shoppingService" class="Wiprospringframework.ShoppingService"/>
 <bean id="loggingAspect" class="Wiprospringframework.LoggingAspect"/>
 
<aop:aspectj-autoproxy/>

  <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="com.mysql.cj.jdbc.Driver" />
        <property name="url" value="jdbc:mysql://localhost:3306/testdb" />
        <property name="username" value="root" />
        <property name="password" value="J@sh8367" />
    </bean>

    <!-- JdbcTemplate -->
    <bean id="jdbcTemplate" class="org.springframework.jdbc.core.JdbcTemplate">
        <property name="dataSource" ref="dataSource" />
    </bean>

    <!-- DAO -->
    <bean id="productDao" class="com.dao.ProductDaoImpl">
        <property name="jdbcTemplate" ref="jdbcTemplate" />
    </bean>

    <!-- Service -->
    <bean id="productService" class="com.service.ProductService">
        <property name="productDao" ref="productDao" />
    </bean>


    
   

    
</beans>
